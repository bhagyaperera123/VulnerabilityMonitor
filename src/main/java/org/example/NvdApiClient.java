//package org.example;
//
//import java.net.URI;
//import java.net.http.HttpClient;
//import java.net.http.HttpRequest;
//import java.net.http.HttpResponse;
//import java.time.LocalDateTime;
//import java.time.format.DateTimeFormatter;
//
//import org.json.simple.JSONArray;
//import org.json.simple.JSONObject;
//import org.json.simple.parser.JSONParser;
//
//public class NvdApiClient {
//    private static final String API_URL = "https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=log4j&resultsPerPage=10&startIndex=";
//    private static final DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm:ss.SSS");
//
//    public static void main(String[] args) {
//        try {
//            HttpClient client = HttpClient.newHttpClient();
//            int startIndex = 0;
//            LocalDateTime mostRecentDate = LocalDateTime.MIN;
//            JSONObject mostRecentVulnerability = null;
//
//            while (true) {
//                HttpRequest request = HttpRequest.newBuilder()
//                        .uri(new URI(API_URL + startIndex))
//                        .header("key", "")
//                        .build();
//
//                HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
//                JSONParser parser = new JSONParser();
//                JSONObject jsonResponse = (JSONObject) parser.parse(response.body());
//
//                JSONArray vulnerabilities = (JSONArray) jsonResponse.get("vulnerabilities");
//                if (vulnerabilities.isEmpty()) {
//                    break;
//                }
//
//                for (Object obj : vulnerabilities) {
//                    JSONObject vulnerabilityWrapper = (JSONObject) obj;
//                    JSONObject vulnerability = (JSONObject) vulnerabilityWrapper.get("cve");
//                    String lastModifiedStr = (String) vulnerability.get("lastModified");
//                    LocalDateTime lastModifiedDate = LocalDateTime.parse(lastModifiedStr, formatter);
//
//                    if (lastModifiedDate.isAfter(mostRecentDate)) {
//                        mostRecentDate = lastModifiedDate;
//                        mostRecentVulnerability = vulnerability;
//                    }
//                }
//
//                startIndex += 10; // Move to the next page
//            }
//
//            if (mostRecentVulnerability != null) {
//                System.out.println("CVE ID: " + mostRecentVulnerability.get("id"));
//                System.out.println("Description: " + ((JSONObject) ((JSONArray) mostRecentVulnerability.get("descriptions")).get(0)).get("value"));
//                System.out.println("Published Date: " + mostRecentVulnerability.get("published"));
//                System.out.println("Last Modified Date: " + mostRecentVulnerability.get("lastModified"));
//                System.out.println("--------------------------------------");
//            }
//
//        } catch (Exception e) {
//            e.printStackTrace();
//        }
//    }
//}
